<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>buying</title>
<link rel="stylesheet" href="../css/buyingmrf.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
</head>
<body>

<!-- Sidebar -->
<div class="sidebar">
    <p class="logo"><img src="../img/PKlogo.PNG" alt=""></p>
    <a href="http://127.0.0.1:5500/html/pk.html">Home</a>
    <a href="http://127.0.0.1:5500/html/rentpage.html">Rents</a>

    <!-- Login button -->
    <button href="#login" class="login-btn">Login</button>
</div>

<!-- <div class="main-content">
<div class="buying-page">
    <div class="buying-img">
    <h4 class="buying-text">MRF Genius Cricket bat 2 - On Rent <br>
    From Rs. 349.00 / day</h4>
    <img class="pro-image" src="../img/cricket/mrfbat-removebg-preview.png" alt="">
</div>
    <div class="buying-btn">
    <input class="str-btn" id="change" onclick="changeme()" type="date" required autofocus></input><br><br>
    <input class="end-btn" id="change" onclick="changeme()" type="date"></input><br><br>
    <input class="tot-btn" id="change" onclick="changeme()" placeholder="Total days"></input>
    <button class="book-btn">Book Now</button>
    </div>
</div>
</div> -->

<div class="main-content">
<div class="buying-page">
    <div class="buying-img">
    <h4 class="buying-text">MRF Genius Cricket bat 2 - On Rent From Rs. <p id="paragraphValue">349 / day</h4>
</div>  
    <div class="buy">
        <div class="pro-img"><img class="pro-image" src="../img/cricket/mrfbat-removebg-preview.png" alt="">
    </div>
    <div class="buying-btn">
    <input class="str-btn" id="date1" type="date" required autofocus></input><br><br>
    <input class="end-btn" id="date2"  type="date" required></input><br><br>
    <input class="tot-btn" id="result"  placeholder="Total days" required></input><br>
    <button class="book-btn" onclick="gotoformpage()">Book Now</button>
    </div>
    </div>
</div>
<div id="popup" class="popup">
  <p>Please select both <b>start</b> and <b>end</b> dates before booking.</p>
</div>

<style>
  .popup {
    display: none;
    position: fixed;
    bottom: 450px;
    left: 76.2%;
    transform: translateX(-50%);
    background: white;
    color: black;
    padding: 14px 25px;
    border-radius: 12px;
    font-family: 'Poppins', sans-serif;
    font-size: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    animation: fadeInOut 2s ease forwards;
  }

  @keyframes fadeInOut {
    0% {opacity: 0; transform: translate(-50%, 20px);}
    10% {opacity: 1; transform: translate(-50%, 0);}
    90% {opacity: 1;}
    100% {opacity: 0; transform: translate(-50%, 20px);}
  }
</style>

<script>
  // ðŸ§® Function to calculate the difference in days
  function getDifferenceInDays(d1, d2) {
    if (!d1 || !d2) return "";
    const diffTime = Math.abs(new Date(d2) - new Date(d1));
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    return diffDays;
  }

  const date1 = document.getElementById("date1");
  const date2 = document.getElementById("date2");
  const result = document.getElementById("result");
  const popup = document.getElementById("popup");

  // ðŸ” Update total days automatically when user changes dates
  function updateDifference() {
    const days = getDifferenceInDays(date1.value, date2.value);
    result.value = days;
  }

  date1.addEventListener("input", updateDifference);
  date2.addEventListener("input", updateDifference);

  // ðŸš€ Main booking function
  function gotoformpage() {
    if (date1.value === "" || date2.value === "") {
      showPopup();
    } else {
      const resultValue = parseFloat(document.getElementById('result').value);
      const paragraphValue = parseFloat(document.getElementById('paragraphValue').innerText);
      const totalAmount = resultValue * paragraphValue;

      // ðŸ’¾ Store total value for next page
      localStorage.setItem('resultvalue', totalAmount);

      // Redirect to form page
      window.location.href = "http://127.0.0.1:5500/html/form.html";
    }
  }

  // ðŸ’¬ Show modern popup for missing inputs
  function showPopup() {
    popup.style.display = "block";
    setTimeout(() => {
      popup.style.display = "none";
    }, 2000);
  }

</script>
</html>